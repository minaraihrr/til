# 20250201

## GAS memo
### createHtmlOutputFromFileとcreateTemplateFromFileの使いどころ
createHtmlOutputFromFile … 静的なhtmlファイルでOKの場合  
createTemplateFromFile … 変数をhtmlに渡したり、htmlファイル内でサーバーサイドの処理を呼んだりして動的にhtmlを変える場合  

### GASでhtmlにmetaタグをつける
-> .addMetaTag()を使う

### createHtmlOutputFromFileの場合
.gs
```
function doGet() {
  return HtmlService
    .createHtmlOutputFromFile('index')
    .addMetaTag('viewport', 'width=device-width, initial-scale=1');
}
```
 
### createTemplateFromFileの場合
.gs
```
function doGet() {
  return HtmlService
    .createTemplateFromFile('Index')
    .evaluate()
    .addMetaTag('viewport', 'width=device-width, initial-scale=1');
}
```
### .gsファイルからhtmlに配列を渡す
-> 配列をJSON文字列に変換してからjsでパースする

### JSON.stringify(), JSON.parse() の使い方
```
const myArray = [1, 2, 3];

// JSのオブジェクトや値からJSON文字列に変換
const json = JSON.stringify(myArray);
console.log(json);      // '[1, 2, 3]'
 
 // JSON文字列からJSのオブジェクトや値に変換
const newArray = JSON.parse(json);
console.log(newArray);  // Array[1, 2, 3]
```

### 使用例
.gs  
```
const arr = ['a', 'b', 'c']
function doGet() { 
  const html = HtmlService.createTemplateFromFile('index');
  html.arr = arr;
  
  return html.evaluate()
}
```
index.html  
```
<body>
  <script>
    const arr = JSON.parse('<?!=JSON.stringify(arr) ?>');
  </script>
</body>

```

## JS 組み合わせ
```JavaScript
// 順列
function genPerm(after, pre, arr, n, used = []) {
    if (n > 0) {
        for (let i = 0; i < arr.length; i++) {
            if (used.includes(i)) continue;
            genPerm(after, [...pre, arr[i]], arr, n - 1, [...used, i]);
        }
    } else {
        after.push(pre);
    }
    return after;
}
```
```JavaScript
// 組み合わせ
function genRepPerm(after, pre, arr, n) {
    if (n > 0) {
        for (let i = 0; i < arr.length; i++) {
            genRepPerm(after, [...pre, arr[i]], arr, n - 1);
        }
    } else {
        after.push(pre);
    }
    return after;
}
```
```JavaScript
// 重複順列
function genCombi(after, pre, arr, n, start = 0) {
    if (n > 0) {
        for (let i = start; i < arr.length; i++) {
            genCombi(after, [...pre, arr[i]], arr, n - 1, i + 1);
        }
    } else {
        after.push(pre);
    }
    return after;
}
```
```JavaScript
// 重複組み合わせ
function genRepCombi(after, pre, arr, n, start = 0) {
    if (n > 0) {
        for (let i = start; i < arr.length; i++) {
            genRepCombi(after, [...pre, arr[i]], arr, n - 1, i);
        }
    } else {
        after.push(pre);
    }
    return after;
}
```
```JavaScript
const arr = ['a', 'b', 'c']
const num = 2
console.log(genPerm([], [], arr, num));
// [
//     ['a', 'b']
//    ,['a', 'c']
//    ,['b', 'a']
//    ,['b', 'c']
//    ,['c', 'a']
//    ,['c', 'b']
// ]
console.log(genRepPerm([], [], arr, num));
// [
//     ['a', 'a']
//    ,['a', 'b']
//    ,['a', 'c']
//    ,['b', 'a']
//    ,['b', 'b']
//    ,['b', 'c']
//    ,['c', 'a']
//    ,['c', 'b']
//    ,['c', 'c']
// ]
console.log(genCombi([], [], arr, num));
// [
//      ['a', 'b']
//     ,['a', 'c']
//     ,['b', 'c']
// ]
console.log(genRepCombi([], [], arr, num));
// [
//     ['a', 'a']
//    ,['a', 'b']
//    ,['a', 'c']
//    ,['b', 'b']
//    ,['b', 'c']
//    ,['c', 'c']
// ]
```
